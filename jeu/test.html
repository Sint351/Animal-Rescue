<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8"/>
        <link rel="stylesheet" href="style.css"/>
    </head>
    
    <body>

        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
        <script src="animal.js"></script>
        <script src="continent.js"></script>
        
        <div id="jeu">
            <div id="joueur"></div>
        </div>
        
        <script>            
            

            /* M A P */
            
            var europe = new continent('europe', 'bg_europe.jpg'); // initialise le continent
            var bg = europe.getSrc(); // source du background
            $('#jeu').after('<img id="fond" src="'+ bg +'"/>'); // place le fond
            $('#fond').animate( {left: '-=4000'}, 15000, 'linear' ); // fait avancer le fond



            /* E C R A N S */
            
            var hauteur_fenetre = $(window).height();
            var haut = (hauteur_fenetre / 2) - ($('#fond').height() / 2);
            
            $('#fond').css({top: haut});
            $('#joueur').css({bottom: haut+70});

            
            
            /* O B S T A C L E */
            
            europe.generationObst();
            var liste_p = europe.getListePlaceObst();
            var liste_t = europe.getListeTypeObst();
            
            for (n in liste_p)
            {
                $('#jeu').after('<div class="obstacle" id="obst'+n+'"></div>');
                $('#obst'+n).css('left', liste_p[n]+'px');
                $('#obst'+n).css({bottom: haut+70});
                                
                if (liste_t[n] === 1)
                {
                    $('#obst'+n).css({bottom: haut+70+70});
                }
            }

            $('.obstacle').animate( {left: '-=4000'}, 15000, 'linear');

            
            
            /* P E R S O */
            
            var renard = new animal('fox_c.png','fox_e.png','renard');
            
            $(document).keydown(function(touche)
            {
                if (touche.which == 38)
                {
                    renard.saute();
                }
                if (touche.which == 40)
                {
                    renard.esquive();
                }
            });
            
            
            
            /* C O L L I S I O N */
            function collision()
            {
                var l_perso = parseInt($('#joueur').css('left'));
                var w_perso = parseInt($('#joueur').css('width'));
                
                var t_perso = parseInt($('#joueur').css('top'));
                var h_perso = parseInt($('#joueur').css('height'));

                for (n in liste_p)
                {
                    var l_obst = parseInt($('#obst'+n).css('left'));
                    var w_obst = parseInt($('#obst'+n).css('width'));
                    
                    var t_obst = parseInt($('#obst'+n).css('top'));
                    var h_obst = parseInt($('#obst'+n).css('height'));
                    
                    if ( ((l_perso+w_perso>l_obst) && (l_perso<l_obst)) || ((l_perso>l_obst) && (l_perso<l_obst+w_obst)))
                    {
                        if ( ((t_perso+h_perso>t_obst) && (t_perso<t_obst)) || ((t_perso>t_obst) && (t_perso<t_obst+h_obst)))
                        {
                            gameOver();
                            console.log('ordonnee');
                            break;
                        }
                    }
                }
            }
            
            setInterval(collision, 20);
            
            
            function gameOver()
            {
                $('body').after('<h1>GAME OVER</h1>');
            }
        </script>
    </body>
</html>
